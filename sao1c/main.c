/*
 * sao1c.c
 *
 * Created: 30.06.2024 14:11:36
 * Author : luni
 */ 

#define F_CPU 8000000L
#include <avr/io.h>
#include <util/delay.h>
#include <avr/interrupt.h>
#include "writeRGB8.h"
	
#define lineWidth  42

const uint8_t text[5][lineWidth] = {
	{0x00,0x00,0x00,0x00,0x00,  0x38, 0x00, 0x00, 0x00, 0x00,  0x38, 0x00,  0xd0, 0x00, 0x00, 0x00,  0x07, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00, 0x00,  0x38, 0x00,   },
	{0x00,0x00,0x00,0x00,0x00,  0x39, 0x00, 0x00, 0x00, 0x00,  0x00, 0x00,  0xd8, 0xd0, 0xc0, 0x00,  0x45, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00, 0x00,  0x00, 0x00,   },
	{0x00,0x00,0x00,0x00,0x00,  0x3a, 0x3b, 0x3c, 0x09, 0x00,  0x70, 0x00,  0xe0, 0x00, 0x00, 0x00,  0x83, 0x00, 0x00, 0x00,  0x41, 0x00, 0x00, 0xc8, 0x00,  0x09, 0x23, 0x2a, 0x08, 0x00,  0xb8, 0x00,   },
	{0x00,0x00,0x00,0x00,0x00,  0x3b, 0x00, 0x00, 0x3d, 0x00,  0xa0, 0x00,  0xa8, 0x08, 0x00, 0x00,  0x82, 0x41, 0x00, 0x00,  0x42, 0x00, 0x00, 0xc5, 0x00,  0x14, 0x00, 0x00, 0x31, 0x00,  0xd8, 0x00,   },
	{0x00,0x00,0x00,0x00,0x00,  0x09, 0x3c, 0x3d, 0x09, 0x00,  0xc0, 0x00,  0x00, 0x70, 0x38, 0x00,  0x00, 0xc1, 0xc0, 0x00,  0x01, 0x83, 0x84, 0x40, 0x00,  0x07, 0x00, 0x00, 0x38, 0x00,  0xf8, 0x00,   },};
//const uint8_t overflow[] = {0,0,0,0,0};
uint8_t frame[25];

int main(void)
{
	//8MHz
	CCP    = 0xD8;
	CLKMSR = 0x00;
	CCP    = 0xD8;
	CLKPSR = 0X00;
	//LEDs output
	DDRB  = (1 << DDB2);
	PUEB  = ~(1<<PUEB2);
	PORTB = (1<<PORTB2);
		
    /* Replace with your application code */
    uint8_t i = 0;
	while (1) 
    {
		i = i + 1;
		if(i == lineWidth)
		i = 0;		
		
		uint8_t *p = (uint8_t*)frame;
		//uint8_t *t = (uint8_t*)&(text[0][i]);
		/*for(uint8_t y = 0; y < 5; y++)
		{
			*(p++) = 1;
			*(p++) = 8;
			*(p++) = 1;
			*(p++) = 8;
			*(p++) = 1;
			//t += lineWidth - 5;
		}*/
		uint8_t *t = (uint8_t*)&(text[4][4 + i]);
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *t;
		t -= lineWidth;
		*(p++) = *(t++);
		*(p++) = *(t++);
		*(p++) = *(t++);
		*(p++) = *(t++);
		*(p++) = *t;
		t -= lineWidth;
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *t;
		t -= lineWidth;
		*(p++) = *(t++);
		*(p++) = *(t++);
		*(p++) = *(t++);
		*(p++) = *(t++);
		*(p++) = *t;
		t -= lineWidth;
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *(t--);
		*(p++) = *(t--);
		// *(p++) = *t;
		writeGRB8(frame);
		_delay_ms(50);
    }
}
